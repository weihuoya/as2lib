<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>as2lib - ActionScript 2.0 Library for Flash MX 2004+</title>
    <meta http-equiv="imagetoolbar" content="no">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="StyleSheet" type="text/css" href="../css/screen.css">
    <link rel="SHORTCUT ICON" href="favicon.ico">
  </head>
  <body>
    <center>
      <table class="mainTable">
        <tr>
          <td class="logo" align="right"><a href="index.html" title="home"><img src="../images/logo.gif" alt="as2lib" class="imageLogo"></a></td>
        </tr>
        <tr>
          <td valign="top">
            <table cellspacing="0" cellpadding="0" class="content">
              <colgroup>
                <col class="left">
                <col class="center">
                <col class="right">
              </colgroup>
              <tr>
                <td><img src="../images/borderTopLeft.gif" alt="" class="imageBorderTopLeft"></td>
                <td><img src="../images/borderTopCenter.gif" alt="" class="imageBorderTopCenter"></td>
                <td><div style="position:absolute"><img src="../images/borderTopRight.gif" alt="" class="imageBorderTopRight"></div></td>
              </tr>
              <tr>
                <td><img src="../images/borderMiddleLeft.gif" class="imageBorderMiddleLeft" alt=""></td>
                <td>
                  <table cellspacing="0" cellpadding="0" class="menuTable">
                    <tr>
                      <td valign="top">
                        <div class="menu">
                         <a href="index.html">Home</a>
                         <a href="aimedTargets.html">Main Issue</a>
                         <a href="workflow.html">Workflow</a>
                         <a href="examples.html">Examples</a>
                         <a href="concepts.html">Concepts</a>
                         <div class="insertLevel">
                         <b>Basic</b>
                         </div>
                         <a href="externalInfos.html">Infos</a>
                        </div>
                        <a href="http://sourceforge.net" class="externalIcons"><img src="http://sourceforge.net/sflogo.php?group_id=as2lib&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo"/></a>
                        <a href="http://validator.w3.org/check/referer" class="externalIcons"><img border="0" src="http://www.w3.org/Icons/valid-html401" alt="Valid HTML 4.01!" height="31" width="88"></a>
                        <a href="http://jigsaw.w3.org/css-validator/" class="externalIcons"><img src="http://jigsaw.w3.org/css-validator../images/vcss" alt="Valid CSS!" height="31" width="88" /></a>
                      </td>
                      <td><img src="../images/seperatorVertical.gif" class="imageSeparatorVertical" alt=""></td>
                      <td class="contentTd">
                        <h1>Basic Classes (worksheet 0.3)</h1>
                        For the success of an project with ActionScript 2.0 it is necessary to integrate additional functions that are low-level in Flash.<br>
                        <br>
                        Low-level called in this connection means that many features work in an "usually not suggested" way to handle operations so that other features don't have to use this techniques.<br>
                        (for example: __proto__, constructor(), ... everything that stay's in connection with static stuff)
                        <table class="listeningTable">
                          <tr>
                            <th>Content</th>
                          </tr>
                          <tr>
                            <td><a href="#OutputHandling" title="Handling different Output during an project">Output handling</a></td>
                          </tr>
                          <tr>
                            <td><a href="#ExceptionHandling" title="Better Handling for Exceptions">Exception handling</a></td>
                          </tr>
                          <tr>
                            <td><a href="#ReflectionHandling" title="Handling of Reflections within Classes">Reflection handling</a></td>
                          </tr>
                          <tr>
                            <td><a href="#EventHandling" title="Handling Events from classes">Event Handling</a></td>
                          </tr>
                          <tr>
                            <td><a href="#TypedArray" title="To make sure all contents are from the same type">Typed Array</a></td>
                          </tr>
                          <tr>
                            <td><a href="#Cloning" title="Cloning of Objects">Cloning</a></td>
                          </tr>
                          <tr>
                            <td><a href="#Overloading" title="Overloading Support for Methods">Overloading</a></td>
                          </tr>
                          <tr>
                            <td><a href="#TestCases" title="System testing with TestCases">Test Cases</td>
                          </tr>
                          <tr>
                            <td><a href="#RegExp" title="Regular Expression Handling within as2">Regular Expressions</a></td>
                          </tr>
                        </table>
                        <ol class="conceptList">
                          <li><a name="OutputHandling"></a><h2>Output handling</h2>
                            Usual output from an Application runs over <code>trace();</code> or an Exception. The Problem of this way is that most Applications work within an Environment where there is no "trace" defined.
                            <ul>
                              <li><h3>Solution</h3>
                                To make sure that all Output can be dynamically handled within any application we create a basic bridge for accessing those Output:
                                <code>class org.as2lib.basic.Out {}</code>
                                that handle all accessing output requests.
                              </li>
                              <li><h3>Featured Output requests</h3>
                                <ul>
                                  <li><h4>.write([String])</h4>
                                    To Write stuff out. (equally to Trace)
                                  </li>
                                  <li><a name="OutputHandling.error"></a><h4>.error([Exception])</h4>
                                    Exceptions are usually not available in an .swf, this should declare them as Exception. This method should ensure that the given Exceptions get well printed. <br>
                                    I suppose that an "TraceOutput" would handle it like:<code>...
public function error (e:Exception) {
  trace(" -- Error Occured -- ");
  trace("    Name: "+e.getClass().getName();
  trace("    Message: "+e.getMessage();
  trace("    StackInformation: "+e.getInformation();
  // and so on.
  // (Only possible example)
}
...</code> and different other System's would display it maybe in an JavaScript Window or they hide some fields, or evaluate different more.
                                  </li>
                                  <li><h4>.log([String])</h4>
                                    Log's differ from usually Output that it's not necessary for developing (you don't need to see them).
                                  </li>
                                </ul>
                              </li>
                              <li><h3>Handling Outputs</h3>
                                As you maybe have recognized, this Method only allows access to one function. To implement the main usage from an bridge we use different OutputWriter.<br>
                                <br>
                                OutputWriter are defined as Classes that implement an Interfaces for delegating the functionality. It should be possible to define one OutputWriter that handles this requests.
                                <code>.setOutputWriter([OutputWriter])</code> should handle this.
                              </li>
                              <li><h3>Output Level</h3>
                                There should be a mechanism to restrict the output level(to save performance or for publishing).
                                <code>.setOutputLevel([Number])</code>
                                The Number should be set as binary Digit:<br>
                                <pre>(0) 000 = No output.
(1) 001 = Exceptions showing.
(2) 010 = Writing Logs.
(4) 100 = Warnings showing.</pre>
and each combinition:
<pre>(7) 111 = Complete Output</pre>
                                 <p class="note">Note: This Issue will probably get changed during the development.</p>
                              </li>
                              <li><h3>Exception Handling</h3>
                                Exceptions shall be thrown when ...
                                <ul>
                                  <li>no Exception was defined (<code>.error()</code>)</li>
                                  <li>the given String was empty (<code>.write()</code>,<code>.log()</code>)</li>
                                  <li>no OutputWriter was available (default value is an "TraceOutputWriter")</li>
                                </ul>
                              </li>
                            </ul>
                          </li>
                          <li><a name="ExceptionHandling"></a><h2>Exception handling</h2>
                            Usual Exceptions within as2 throws output directly to to trace. The Problem is that a usual exception has no standard layout and there are some features missing.<br>
                            We build an Basic Exception Class that handles some various problems for us:
                            <ul>
                              <li><h3>Problem with the stacktrace</h3>
                                Actually its not possible to have an stacktrace when an exception gets thrown. The only acceptable solution can be reached by <a href="#ReflectionHandling" title="Handling informations for classes">Reflections</a>. It will be possible (that has been well testet) that it's not neccesary to insert "place" and "inFunction" var for getting the info's from the object that would be called.<br>
                                <br>
                                So we generate the classname (where the exception occured, <code>this</code>), the name of the function (where the exception occured <code>arguments.callee</code>) and all supplied arguments by the statement <code>arguments</code> that is setted by flash for each function.<br>
                                There is an additional possibility for knowing the formerCall from the Object.</li>
                              <li><h3>Naming problem</h3>
                                Within as2 its not with the standard possible to fetch the name from an exception. Using <a href="#ReflectionHandling" title="Handling informations for classes">Reflections</a> we won't be used to this anymore. The Exception class should set its .name with the help from <a href="#ReflectionHandling" title="Handling informations for classes">Reflections</a> self.
                              </li>
                              <li><h3>Output problem</h3>
                                The standard output when an exception occurs is in as2 very "small-sized". The as2 internal .toString() should only be improved in case to have an little better solution (for example:<code>[Exception WrongArgumentsException]</code>). Of course, using this way won't be very nice to view an exception. To really put out an Exception the Exception should redirect itself to the <a href="#OutputHandling.error" name="Error handling within the standard output system">Outputhandling</a> by using something like<code>...
public function toString () {
  org.as2lib.Out.error(this); // Everything next is up to the Output implementation.
  return "[Exception "+getClass().getName()+"]";
}
...</code>. There should be an possibility for preventing this functionality but i don't see bigger problems with that (mail to me if think there is an problems with that:<a href="mailto:mastakaneda@sourceforge.net" title="Martin Heidegger">mastakaneda@sourceforge.net</a>)
                              </li>
                              <li><h3>Exception Conversion</h3>
                                You might have the used case that an Exception from type "a" that has been thrown should be transformed to a exception from type "b".<br>
                                <br>
                                It should be a quite comfortable way if an exception handles this with an standard function.
                                <code>myException.convertTo(org.as2lib.basic.exceptions.WrongArgumentsException);</code>
                                <p class="note">Note: Java handles this with an overloaded constructor(one using message, another one using another exception for the information). Quite not a fine way for as2, but i will maybe change my opinion by response.</p> 
                              </li>
                              <li><h3>Spoken in Code</h3>
                                <ul>
                                  <li><h4>Enduser</h4>The enduser will see an exception similar to this by the OutputHandler (formed by the OutputHandler):
                                    <pre>--- Exception Occured ---
  type: org.as2lib.basic.exceptions.WrongArgumentsException
  message: You did something wrong.
  by: org.as2lib.basic.StringUtil.trim([String 'home'], [Array 'my', 'yours', 'them']);
  formerCall: org.as2lib.basic.StringUtil.trimLeft(&lt;unknown&gt;);</pre>
                                  </li>
                                  <li><h4>Developers</h4>
                                    The developer will have to code this:
                                    <code>throw new org.as2lib.basic.exceptions.WrongArgumentsException('You did something wrong.', arguments);</code>
                                  </li>
                                  <li><h4>ExceptionDeveloper</h4>
                                   The Exceptiondeveloper will have to code an exception like this:
                                  <code>class org.as2lib.basic.exceptions.WrongArgumentsException extends Exception {
  function WrongArgumentsException (message:String, infoArguments:Array) {
    super(message, infoArguments);
  }
}</code>
                                  </li>
                                </ul>
                              </li>
                            </ul>
                          </li>
                          <li><a name="ReflectionHandling"></a><h2>Reflection handling</h2>
                            Java has a functionality for getting a classes name, methods and properties.<br>
                            Actually it's inbuilt in Java. Flash hasn't got something like that "inbuilt". This might be a serious problem, so to solve this is very near.
                            <h3>two Systems</h3>
                            For using Reflections there will be a two way System:
                            <ul>
                              <li><h4>The Reflections Class</h4>
                                There will be a basic class that handles all functionality that Reflections Support.
                              </li>
                              <li><h4>The Basic Class</h4>
                                There will be a basic class that every class should support (in Java this would an abstract class). One of its functionality will be to allow direct access to Reflection-Functionality:
                                <code>.getClass().getName();</code>
                              </li>
                            </ul>
                            <h3>Logical Description</h3>
                            The question i've heard most about this is "How the hell should this work?". There is an simple Answer: I use all scopeable areas that are available (starting with _level0 and _global), then i save all informations and step the name throught until i find the first instance, from there i will get the path. With the Path and "eval" i'm able to fetch everything else.
                            <h3>Implemented Functionality</h3>
                            <ul>
                              <li><h3>Class Fetching</h3>
                                It should be possible to fetch informations about an class.
                                <code>Reflections.getClass([Class]/[Instance]);</code>
                                The result should be an Instance of an ReflectionObject. This object contains informations about static vars, methods, name and the extended class.
                                <code>ReflectionObject.getStaticVars():Array
ReflectionObject.getMethods():Array
ReflectionObject.getExtendedClass():ReflectionObject
ReflectionObject.getName():String
ReflectionObject.getVars():Array</code>
                                <p class="note">Note: All functions use "lacy creation" so that no performance won't be lost.</p>
                              </li>
                              <li><h3>Instance Fetching</h3>
                                Very different to class fetching is instance fetching, major because it creates a lot of troubles with recursion and there should be really all cases checked. More details will follow after more tests.
                              </li>
                            </ul>
                          </li>
                          <li><a name="EventHandling"></a><h2>Event Handling</h2>
                            Eventhandling within as2 should be a two sided sword. On the one hand it is necessary to have an easy handling for an event itself. On the other hand is generic eventhandling a problem because you can't guarantee that all event's fired reach the final client.<br>
                            <h3>Generic Eventhandling</h3>
                            For generic eventhandling there will be a (abstract) class <code>org.as2lib.basic.EventableElement extends BasicObject</code> to handle general events. This class will not have ANY public method. But this class should be based on the EventDispatcher by Macromedia.<br>
                            <br>
                            This class will provide the functionality to register and fire generic events by <code>.addEventListener(object, "event");
.removeEventListener(object, "event");</code>
                            <h3>Eventrule for Using</h3>
                            For cute Handling of this code the Workflow will have to look like this:
                            <ol>
                              <li>The Classwriter should define an Interface where all Event's are defined (how should elseway be sure that you implement Events?)
                                <code>interface MyEventInterface {
  function onClick(e:MyEventObject):Void;
  function onRelease(e:MyReleaseEventObject):Void;
}</code>
                              </li>
                              <li>The Classwriter will have to define methods to add an Object using this Events.
                                <code>class MyClass {
  public function addMyEventListener(obj:MyEventInterface) {
    this.addEventListener(obj, "onClick");
    this.addEventListener(obj, "onRelease");
  }
}</code>
                              </li>
                              <li>The User from the Code will have to take a look at the Interface.
                                <code>class MyEventListener implements MyEventInterface, AnotherEventInterface {
  public function onClick(e:MyEventObject):Void {
    // does something
  }
  public function onRelease(e:MyEventObject):Void {
    // does something different
  }
  // and other events
}</code></li>
                              <li>Then the user add's his Eventhandler to the Object
                                <code>new MyClass().addMyEventListener(new MyEventListener());</code>
                              </li>
                            </ol>
                            <h3>Why so complicated?</h3>
                            This is actually the best way to ensure that a function is really available and it finally reduces the operation speed of eventhandling by a better Code Handling.
                            Of Course this way isn't perfect. It will maybe get changed within an future worksheet by an better idea, but actually i see no different possibility.
                            <h3>Different access</h3>
                            Well, first previewable Problem will be that one class is not able to extend this Eventhandler, because it has already extended on class.
                            The simplest way to allow this way is to get an Eventhandler as instance.
                            <code>function MyClass () {
  this.eventHandler = new org.as2lib.basic.EventHandler();
}</code>
                            And the rest works as used only with "this.eventhandler.addEventListener()" instead of "this.addEventListener()". The only problem ist that we have already the abstract class, so this class has to be an own extension:<code>class org.as2lib.basic.EventHandlerUseable extends org.as2lib.basic.EventHandler /* Names not fixed */ {
  public function addHandler( ... ) {
    return(this.addEventHandler( ... ));
  }
  ... // or similar
}</code>
                            <p class="note">Note: this Issue might change a little. (naming and real functionality)</p>
                          </li>
                          <li><a name="TypedArray"></a><h2>Typed Array</h2>
                            A typical problem using as2 is that an Array might have one or more types within an Array, in most cases, this is very problematic, especially when you want to publish your classes (within a team or generally), because other people can easily create chaos when they don't watch. 
                            <h3>Where to find?</h3>
                            Of course we need an Class you will find it at org.as2lib.basic.TypedArray. This class will use the as2 Array class and uses all Methods like Array as an Bridge. It should not be possible to directly set/get an Value like <code>#
myArray = new Array();
myArray["name"] = "bunny";</code> because the Compiler would not check it. We cant prevent this (the compiler completly blows it). But at least we can bind ( by not using an dynamic class, like Array is) that <code>
myArray.name = "bunny"</code> will not work.
                            <h3>Typedefinition</h3>
                            The type of an Array should be defined within the constructor. Infact the Type should be the hole lifetime the same.<code>new TypedArray(org.as2lib.basic.Exception)</code>
                            <h3>Typeinsurance</h3>
                            We have an "not-dynamic" Class. So there must be methods for adding an value within this array with an name.
                            <ul>
                              <li>validation: <code>public function checkType(value) {
  if(value instanceof this.type) {
    return(this.type);
  } else {
    throw new org.as2lib.basic.exceptions.WrongTypeException("The given Value doesn't match to the Array's type");
  }
}</code></li>
                              <li>setting: <code>public function setValue(name:String, to) {
  this.internalArray[name] = checkType(to);
}</code></li>
                              <li>getting: <code>public function getValue(name:String) {
  return(this.internalArray[name])
}</code></li>
                            </ul>
                            <h3>Bridge Functionality</h3>
                            Even the validation and the setting/getting of values are almost simple bridge functionalities. Different Methods like "sort, push, pop, ...." can surly be simple ported.
                          </li>
                          <li><a name="Cloning"></a><h2>Cloning</h2>
                            Cloning like in Java would run with an simple Interface that defines "this class is cloneable"(this will also exist in our case). Of course this interface should be shurly used by us too but also it as2 allows us an generic clone.
                            <h3>Idea</h3>Often it's complicating that the compiler won't check all possibilities and no exceptions won't be thrown (even if the developer does really bad stuff). But it gives us the possibilty for simple using the objects constructor and proto to make a real clone with that. One &quot;for(in)&quot; loop could handle all that.                            <h3>Location</h3>
                            Of course it's basic functionality like <a href="#ReflectionHandling" title="Basically Stuff for Classhandling with Reflections">Reflections</a> so this should be also in the "BasicClass" that all other extend as ".clone()" Method.
                            <h3>Access points</h3>
                            The code/handling should be in an Util class &quot;org.as2lib.basic.Helper&quot;(or something like that)
                            <h3>Complete cloning</h3>
                            Sometimes it is a real problem that cloning only clones one level. There should be additionally an Method to clone the complete tree &quot;.cloneComplete&quot; which is defined as &quot;Chain of Responsibility&quot; (Design Pattern) this simply uses &quot;.cloneComplete&quot; recursivly (okay it's a little more difficult).
                            <p class="note">Note: Interfaces (specially small one) make problems with casting, therefore this won't be available within an interface.</p>
                          </li>
                          <li><a name="Overloading"></a><h2>Overloading</h2>
                            Of course we all should avoid overloading as good as possible, it's not beautiful that as2 doesn't support it but its logical and we have all to live with it. The "standard-way" of using overloading is pretty ugly combined with a lot of if's and code. So we decided to support this feature.
                            <h3>Target</h3>
                            Maybe the future presets for us a as2 that supports overloading, but not now. But we should be prepared for that, so each possibility should be defined in its own function:
                            <code>public function doSomethingWay1() {
}
public function doSomethingWay2() {
}</code>
                            In this case it will be nice in future to change it to a supported overloading. The second thing is that this can be well documented. But this means an Separation for this overloading would look like this:
                            <code>public function doSomething() {
  if(arguments[0] instanceOf Home) {
    doSomethingWay1(arguments[0], arguments[1]);
  } else {
    doSomethingWay2(arguments[0]);
  }
}</code>
                            This is everytime a new challenge for the developer and may cause a lot of problems. Because if you want to check all you have unreadable code, a source for errors and maybe unchecked causes (what if the arguments don't match any case?!). Here is where we want to bring our part into the game. We should provide a functionality that handles these switch automatically. This functionality should be provide the same way like the Reflections: within the basic class and as util. There you should only use a predefined method for that:
                            <code>public function doSomething() {
  overload (
    arguments,
    createOverloadHandler([String, Number], "doSomethingWay1"),
    createOverloadHandler([String], "doSomethingWay2")
  );
}</code>
                            <p class="note">Note: This is not the final code! The Syntax might change!<br>
                            Note 2: "this." Keyword is not important, it will be set by the compiler.<br>
                            Note 3: createOverloadHandler returns an OverloadHandler Instance from the Utils Class.
                            </p>
                            <h3>Wrong calls</h3>
                            A wrong call is a wrong call if it's size and it's types have no match. In this case, an exception will be thrown.
                            <h3>Public Access</h3>
                            The public Access over the Util Class will look like:<code>import org.as2lib.basic.BasicUtil;
 ...
 public function doSomething() {
   BasicUtil.overload (
     this,
     arguments,
     BasicUtil.createOverloadHandler([String, Number], "doSomethingWay1"),
     BasicUtil.createOverloadHandler([String], "doSomethingWay2")
   );
 }</code>So the complete Handling will work even if the basic Class can't be extended.
                           <h3>Possible Extension</h3>
                           There could be a possible Extension to insert Wildcards where an (un)-limited part of vars from a type can follow. (future release)
                          </li>
                          <li><a name="TestCases"></a><h2>Test Cases</h2>
                            After a lot discussion we decided to use our own test system instead of the <a href="http://www.as2unit.org" title="Testcases by iteration:two">as2unit</a>, specially because they use components and don't support a lot of methods.
                            <h3>What are Testcases</h3>
                            A Testcase is a Class/Method that checks a different method if it works correctly. A Developer has to write a Testcase alone for his class, a Testcase system has to provide the functionality for automated testing
                            <h3>What we do like other systems</h3>
                            We have (like all other System too) a basic Class that should be extended. This class will support different functionalities to compare values and define wether a testcase failed or not (for example: assertEquals(), assertTrue() etc.). For all this functionality there should be a inverse functionality to check the difference (example: assertNotEquals(), assertFalse(), etc.).<br>Usually a TestcaseSystem works with overloading, but in fact, we decided to use this as rare as posible so each method should have an additional method to provide an message to the failure (for example: assertTrueWithMessage(), assertFalseWithMessage(), etc.). <p class="note">Note: with as2unit you have also to make different notations to the testcase itself, we will avoid this.</p>
                            <h3>Running Code</h3>
                            To run Testcases you should not have to do two different things(as as2unit has). Developers should be able to start a testcase within an call(not add a whole component to the stage). This should work with &lt;basicClass&gt;.run(&quot;&lt;path&gt;&quot;) this way is usual and simple but within flash it doesn't compile the testcase if you use an string. So we will provide a second access to run an testcase seperatly with &lt;basicClass&gt;.runClass(&lt;path&gt;) so the Class itself will be compiled because it is defined as is within the call.
                            <h3>Handling Output</h3>
                            The Output Handling should run over the standard OutputHandling. Simple Text Output to Asccii graphics. Another difference to other testsystems should be defined by displaying more details within the result (like which testcases were found and which work correctly), mostly because it's often not clear whether a testcase is found or not.
                          </li>
                          <li><a name="RegExp"></a><h2>Regulary Expressions</h2>
                            Regulary Expression might count to the StringUtils but in my opinion Regulary Expressions can handle a lot and improve the work well, so i put it to the Basic Concept.<br>
                            <h3>What are Regulary Expressions?</h3>
                            Regulary Expressions are a simple but mighty way to search within Strings. JavaScript supports Regulary Expressions well and i got no idea why flash not.
                            <h3>How will they be supported?</h3>
                            Support will come within an Util Class. One Accesspoint (at least) will handle a Regulary Expression. Further details will come during real concept and Worksheet for this.
                            <p class="note">Note: This has the lowest priority.</p>
                          </li>
                        </ol>
                      </td>
                    </tr>
                  </table>
                </td>
                <td><img src="../images/borderMiddleRight.gif" class="imageBorderMiddleRight" alt=""></td>
              </tr>
              <tr>
                <td><img src="../images/borderBottomLeft.gif" alt="" class="imageBorderBottomLeft"></td>
                <td><img src="../images/borderBottomCenter.gif" alt="" class="imageBorderBottomCenter"></td>
                <td><img src="../images/borderBottomRight.gif" alt=""